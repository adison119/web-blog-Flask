{% extends "base.html" %}
{% block content %}
<h1>โพสต์ล่าสุด</h1>
{% if posts %}
  <ul class="post-list">
    {% for p in posts %}
      <li class="post-card">
        {% if p.image_filename %}
        <a href="{{ url_for('main.post_detail', post_id=p.id) }}">
          <img class="post-thumb" src="{{ url_for('static', filename='uploads/' ~ p.image_filename) }}" alt="">
        </a>
        {% endif %}
        <a class="title" href="{{ url_for('main.post_detail', post_id=p.id) }}">{{ p.title }}</a>
        <div class="meta">โดย {{ p.author.username }} • {{ p.created_at.strftime('%Y-%m-%d %H:%M') if p.created_at else '' }}</div>
        {% if current_user.is_authenticated and p.author_id == current_user.id %}
        <div class="actions">
          <a href="{{ url_for('main.post_edit', post_id=p.id) }}">แก้ไข</a>
          <form action="{{ url_for('main.post_delete', post_id=p.id) }}" method="post" onsubmit="return confirmDelete()">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <button type="submit" class="link danger">ลบ</button>
          </form>
        </div>
        {% endif %}
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>ยังไม่มีโพสต์</p>
{% endif %}
{% endblock %}
